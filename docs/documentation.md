# Documentation de l'Architecture - Food Truck Mobile App

## Vue d'ensemble

Cet application est une solution mobile moderne d√©velopp√©e avec **React Native** et **Expo**, utilisant une architecture bas√©e sur les **Contextes React** pour la gestion d'√©tat global et **Expo Router** pour la navigation.

## Architecture g√©n√©rale

### Stack technologique

- **Frontend** : React Native 0.79.4
- **Framework** : Expo SDK 53
- **Navigation** : Expo Router 5.1.2
- **Langage** : TypeScript 5.8.3
- **Gestion d'√©tat** : React Context API
- **Stockage local** : AsyncStorage
- **UI Components** : React Native Elements + Lucide React Native
- **Animations** : React Native Reanimated

### Architecture en couches

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           UI Layer                  ‚îÇ
‚îÇ  (Components, Screens, Navigation)  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ         Business Logic              ‚îÇ
‚îÇ    (Contexts, Services, ...)        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ         Data Layer                  ‚îÇ
‚îÇ    (AsyncStorage, JSON Data)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Structure des dossiers

### `/app` - Pages et Navigation (Expo Router)

L'application utilise le syst√®me de routage bas√© sur les fichiers d'Expo Router :

```
app/
‚îú‚îÄ‚îÄ _layout.tsx              # Layout racine avec providers
‚îú‚îÄ‚îÄ welcome.tsx              # Page d'accueil / page de bienvenue
‚îú‚îÄ‚îÄ (auth)/                  # Groupe de routes d'authentification
‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx         # Layout pour les pages auth
‚îÇ   ‚îú‚îÄ‚îÄ login.tsx           # Page de connexion
‚îÇ   ‚îú‚îÄ‚îÄ register.tsx        # Page d'inscription
‚îÇ   ‚îî‚îÄ‚îÄ changePassword.tsx  # Page de changement de mot de passe
‚îú‚îÄ‚îÄ (tabs)/                  # Groupe de routes principales
‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx         # Layout avec navigation par onglets
‚îÇ   ‚îú‚îÄ‚îÄ index.tsx           # Page principale (liste des produits)
‚îÇ   ‚îú‚îÄ‚îÄ notifications.tsx   # Page des notifications
‚îÇ   ‚îî‚îÄ‚îÄ profile.tsx         # Page de profil
‚îú‚îÄ‚îÄ product/                 # Routes de gestion des produits
‚îÇ   ‚îú‚îÄ‚îÄ [id].tsx            # D√©tail d'un produit
‚îÇ   ‚îú‚îÄ‚îÄ add.tsx             # Ajout de produit
‚îÇ   ‚îî‚îÄ‚îÄ edit/
‚îÇ       ‚îî‚îÄ‚îÄ [id].tsx        # Modification de produit
‚îú‚îÄ‚îÄ analytics.tsx            # Page de statistiques des produits
‚îî‚îÄ‚îÄ +not-found.tsx          # Page 404
```

### `/components` - Composants r√©utilisables

Organisation modulaire des composants par domaine fonctionnel :

```
components/
‚îú‚îÄ‚îÄ Analytic/               # Composants de statistique
‚îÇ   ‚îú‚îÄ‚îÄ DistributionChart.tsx       # Composant pour les stats par distibution (categorie, vendeur, stock...)
‚îÇ   ‚îú‚îÄ‚îÄ OverviewStatistics.tsx      # Composant pour vue generale des produits
‚îÇ   ‚îú‚îÄ‚îÄ SimpleChart.tsx             # Composant utilis√© par DistributionChart
‚îÇ   ‚îî‚îÄ‚îÄ StatCard.tsx                # Composant utilis√© par OverviewStatistics
‚îú‚îÄ‚îÄ Common/                 # Composants communs
‚îÇ   ‚îú‚îÄ‚îÄ EmptyDataMessage.tsx        # Composant pour afficher le message si les donn√©es a afficher sont vides
‚îÇ   ‚îú‚îÄ‚îÄ GlobalLoadingSpinner.tsx    # Composant de loading (avec le message)
‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx                  # Composant de en-tete des pages
‚îÇ   ‚îú‚îÄ‚îÄ LoadingSpinner.tsx          # Composant utilis√© par GlobalLoadingSpinner
‚îÇ   ‚îú‚îÄ‚îÄ SelectionModal.tsx          # Composant pour afficher des options en modal (ex: Categorie, Vendeur...)
‚îú‚îÄ‚îÄ Form/                   # Composants de formulaire
‚îÇ   ‚îú‚îÄ‚îÄ ButtonForm.tsx              # Composant de bouton utilis√© dans tous les pages
‚îÇ   ‚îú‚îÄ‚îÄ ImageUrlModal.tsx           # Composant pour entrer l' "url option" dans le formulaire
‚îÇ   ‚îú‚îÄ‚îÄ InputForm.tsx               # Composant de input utilis√© dans tous les pages
‚îÇ   ‚îú‚îÄ‚îÄ ProductForm.tsx             # Composant pour produits (ajout et modification)
‚îÇ   ‚îî‚îÄ‚îÄ SelectForm.tsx              # Composant de select utilis√© dans tous les pages
‚îú‚îÄ‚îÄ ProductList/            # Composants de liste
‚îÇ   ‚îú‚îÄ‚îÄ FilterPanels.tsx            # Composant de filtre dans la page liste des produits
‚îÇ   ‚îú‚îÄ‚îÄ Pagination.tsx              # Composant Pagination
‚îÇ   ‚îî‚îÄ‚îÄ ProductCard.tsx             # Composant pour afficher un de produit
‚îú‚îÄ‚îÄ Notification/           # Composants de notification
‚îÇ   ‚îî‚îÄ‚îÄ NotificationItem.tsx        # Composant pour une notification
‚îú‚îÄ‚îÄ Profil/                 # Composants de profil
‚îÇ   ‚îî‚îÄ‚îÄ EditProfil.tsx              # Composant pour un petit formulaire de modification de profil
```

### `/contexts` - Gestion d'√©tat global

L'application utilise le pattern Context API de React pour la gestion d'√©tat global :

```
contexts/
‚îú‚îÄ‚îÄ AuthContext.tsx         # Gestion de l'authentification
‚îú‚îÄ‚îÄ DataContext.tsx         # Gestion des donn√©es produits
‚îú‚îÄ‚îÄ LoadingContext.tsx      # Gestion des √©tats de chargement
‚îú‚îÄ‚îÄ NotifContext.tsx        # Gestion des notifications
‚îî‚îÄ‚îÄ ThemeContext.tsx        # Gestion du th√®me (clair/sombre)
```

### `/data` - Donn√©es statiques

Donn√©es JSON pour le d√©veloppement et les tests :

```
data/
‚îú‚îÄ‚îÄ categories.json         # Cat√©gories de produits
‚îú‚îÄ‚îÄ products.json          # Produits de d√©monstration
‚îú‚îÄ‚îÄ sellers.json           # Vendeurs
‚îî‚îÄ‚îÄ users.json             # Utilisateurs de test
```

## üîÑ Flux de donn√©es

### Architecture de gestion d'√©tat

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Components    ‚îÇ    ‚îÇ    Contexts     ‚îÇ    ‚îÇ   AsyncStorage  ‚îÇ
‚îÇ                 ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ                 ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ                 ‚îÇ
‚îÇ  (UI Layer)     ‚îÇ    ‚îÇ (State Layer)   ‚îÇ    ‚îÇ (Persistence)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚ñº                       ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   User Input    ‚îÇ    ‚îÇ  State Updates  ‚îÇ    ‚îÇ  Data Storage   ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Flux d'authentification

1. **Connexion** : `AuthContext.login()` ‚Üí Validation ‚Üí AsyncStorage ‚Üí Mise √† jour √©tat
2. **Inscription** : `AuthContext.register()` ‚Üí Hashage mot de passe ‚Üí Ajout utilisateur
3. **D√©connexion** : `AuthContext.logout()` ‚Üí Nettoyage AsyncStorage ‚Üí Reset √©tat

### Flux de gestion des produits

1. **Lecture** : `DataContext` ‚Üí Chargement depuis JSON ‚Üí Mise √† jour √©tat
2. **Cr√©ation** : Formulaire ‚Üí Validation ‚Üí Ajout au contexte ‚Üí Persistance
3. **Modification** : Formulaire ‚Üí Validation ‚Üí Mise √† jour contexte ‚Üí Persistance
4. **Suppression** : Confirmation ‚Üí Suppression du contexte ‚Üí Persistance

## Syst√®me d'authentification

### Architecture de s√©curit√©

- **Hashage des mots de passe** : bcryptjs avec salt rounds = 10
- **Stockage s√©curis√©** : AsyncStorage pour la persistance locale
- **Validation** : V√©rification email unique, formatage des donn√©es
- **Session** : Gestion automatique de la session utilisateur

### Interface AuthContext

```typescript
interface AuthContextType {
  user: User | null;
  isLoading: boolean;
  login: (email: string, password: string) => Promise<boolean>;
  register: (name: string, email: string, password: string) => Promise<boolean>;
  logout: () => Promise<void>;
  changePassword: (email: string, newPassword: string) => Promise<boolean>;
  updateProfile: (name: string, email: string) => Promise<boolean>;
}
```

## Syst√®me de donn√©es

### Mod√®le de donn√©es

#### Produit
```typescript
interface Product {
  id: string;
  name: string;
  description: string;
  price: number;
  stock: number;
  category: string;
  seller: string;
  image: string;
  isActive: boolean;
  createdBy: string;
  createdAt: string;
}
```

#### Utilisateur
```typescript
interface User {
  id: string;
  email: string;
  name: string;
  password: string; // Hash√© en production
}
```

### Gestion des donn√©es

- **Source de donn√©es** : Fichiers JSON statiques pour le d√©veloppement
- **Persistance** : AsyncStorage pour les donn√©es utilisateur
- **Cache** : √âtat local dans les contextes React
- **Synchronisation** : Mise √† jour en temps r√©el via les contextes

## Syst√®me de th√®me

### Architecture du th√®me

- **Provider** : `ThemeContext` g√®re l'√©tat du th√®me
- **Persistance** : AsyncStorage pour sauvegarder la pr√©f√©rence
- **Application** : Couleurs et styles dynamiques
- **Composants** : Adaptation automatique au th√®me actuel

### Couleurs et styles

```typescript
// constants/Colors.ts
export default {
  light: {
    text: '#000',
    background: '#fff',
    tint: tintColorLight,
    tabIconDefault: '#ccc',
    tabIconSelected: tintColorLight,
  },
  dark: {
    text: '#fff',
    background: '#000',
    tint: tintColorDark,
    tabIconDefault: '#ccc',
    tabIconSelected: tintColorDark,
  },
};
```

## Syst√®me de notifications

### Architecture des notifications

- **Context** : `NotifContext` g√®re l'√©tat des notifications
- **Types** : Succ√®s, erreur, information, avertissement
- **Persistance** : Stockage local des notifications
- **Affichage** : Composants d√©di√©s avec animations

### Interface de notification

```typescript
interface Notification {
  id: string;
  type: 'success' | 'error' | 'info' | 'warning';
  title: string;
  message: string;
  timestamp: Date;
  read: boolean;
}
```

## Navigation et routage

### Expo Router

L'application utilise Expo Router pour une navigation bas√©e sur les fichiers :

- **Routage automatique** : Bas√© sur la structure des dossiers
- **Navigation imbriqu√©e** : Groupes de routes pour l'organisation
- **Param√®tres dynamiques** : Routes avec `[id].tsx`
- **Layouts** : Layouts sp√©cifiques par groupe de routes

### Structure de navigation

```
Root Layout (_layout.tsx)
‚îú‚îÄ‚îÄ Welcome
‚îú‚îÄ‚îÄ Auth Group ((auth)/_layout.tsx)
‚îÇ   ‚îú‚îÄ‚îÄ Login
‚îÇ   ‚îú‚îÄ‚îÄ Register
‚îÇ   ‚îî‚îÄ‚îÄ Change Password
‚îú‚îÄ‚îÄ Tabs Group ((tabs)/_layout.tsx)
‚îÇ   ‚îú‚îÄ‚îÄ Home (index)
‚îÇ   ‚îú‚îÄ‚îÄ Notifications
‚îÇ   ‚îî‚îÄ‚îÄ Profile
‚îú‚îÄ‚îÄ Product Routes
‚îÇ   ‚îú‚îÄ‚îÄ Product Detail ([id])
‚îÇ   ‚îú‚îÄ‚îÄ Add Product
‚îÇ   ‚îî‚îÄ‚îÄ Edit Product ([id])
‚îî‚îÄ‚îÄ Analytics
```


## Performance et optimisation

### Strat√©gies d'optimisation

- **Lazy loading** : Chargement √† la demande des composants
- **Bundle splitting** : S√©paration du code par fonctionnalit√©

### Monitoring

- **Performance** : M√©triques de rendu et navigation
- **Erreurs** : Capture et reporting des erreurs
- **Analytics** : Suivi des interactions utilisateur
- **Crash reporting** : Rapports de crash automatiques

## √âvolutions futures

### Am√©liorations pr√©vues

1. **Push notifications** : Notifications push avec Expo Notifications
2. **Offline mode** : Synchronisation hors ligne
3. **Responsive et design** : Plus moderne et mieux responsive
5. **Internationalisation** : Support multi-langues
6. **Accessibilit√©** : Am√©lioration de l'accessibilit√©

### Architecture √©volutive

L'architecture actuelle est con√ßue pour faciliter l'√©volution :

- **S√©paration des couches** : Facilite l'ajout de nouvelles fonctionnalit√©s
- **Contextes modulaires** : Permet l'ajout de nouveaux contextes
- **Composants r√©utilisables** : R√©duction de la duplication de code
- **TypeScript** : S√©curit√© de type pour l'√©volution du code
